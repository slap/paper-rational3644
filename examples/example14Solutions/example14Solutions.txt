#currentdir("C:/Users/Usuario/Documents/GitHub/sums-of-squares/rationalSOS"); 
#read "rationalSOS.mpl"; 
read "../../codes/maple_codes/rationalSOS.mpl";
with(rationalSOS); 
with(LinearAlgebra); 

interface(rtablesize = infinity);
alias(t = RootOf(Z^5-2));

p1 := 394564743000*t^4*x^5-8765284258800*t^4*x^4*y+46831164496800*t^4*x^4*z-517081266212400*t^4*x^3*y^2-261450720311600*t^4*x^3*y*z-58198295544600*t^4*x^3*z^2+1036418462450000*t^4*x^2*y^3+472627584083200*t^4*x^2*y^2*z+477643287387600*t^4*x^2*y*z^2-69030337300800*t^4*x^2*z^3+677952026697000*t^4*x*y^4-1941814012932800*t^4*x*y^3*z-440443305450600*t^4*x*y^2*z^2+258352273131200*t^4*x*y*z^3+42946805364000*t^4*x*z^4-423233182223600*t^4*y^5+572911933425600*t^4*y^4*z+359027856387600*t^4*y^3*z^2-138702902289600*t^4*y^2*z^3-54451554781600*t^4*y*z^4+7342247366400*t^4*z^5-394564743000*t^3*x^5+8370719515800*t^3*x^4*y-45647470267800*t^3*x^4*z+524925899404200*t^3*x^3*y^2+191480220982400*t^3*x^3*y*z+197508094806000*t^3*x^3*z^2-501033052123400*t^3*x^2*y^3-1933529794035400*t^3*x^2*y^2*z-808770455172000*t^3*x^2*y*z^2-244874348594400*t^3*x^2*z^3-465137865051600*t^3*x*y^4+634284582651200*t^3*x*y^3*z+2068954922101200*t^3*x*y^2*z^2+842290827028000*t^3*x*y*z^3+63866868628800*t^3*x*z^4+241847532699200*t^3*y^5+139041993962400*t^3*y^4*z-636636720602400*t^3*y^3*z^2-501323670139200*t^3*y^2*z^3-64849625364800*t^3*y*z^4+14684494732800*t^3*z^5+131521581000*t^2*x^4*z-2614877730600*t^2*x^3*y*z+15478866584600*t^2*x^3*z^2-178461803442200*t^2*x^2*y^2*z-48418007009200*t^2*x^2*y*z^2-34878298432800*t^2*x^2*z^3-70938053881800*t^2*x*y^3*z+223028981781800*t^2*x*y^2*z^2+126249739795200*t^2*x*y*z^3+11868185999200*t^2*x*z^4+60461883174800*t^2*y^4*z-55932326271600*t^2*y^3*z^2-75260690743200*t^2*y^2*z^3-12439881420000*t^2*y*z^4+2447415788800*t^2*z^5+131521581000*t*x^4*y-2614877730600*t*x^3*y^2+15478866584600*t*x^3*y*z-178461803442200*t*x^2*y^3-48418007009200*t*x^2*y^2*z-34878298432800*t*x^2*y*z^2-70938053881800*t*x*y^4+223028981781800*t*x*y^3*z+126249739795200*t*x*y^2*z^2+11868185999200*t*x*y*z^3+60461883174800*t*y^5-55932326271600*t*y^4*z-75260690743200*t*y^3*z^2-12439881420000*t*y^2*z^3+2447415788800*t*y*z^4+131521581000*x^5-2614877730600*x^4*y+15478866584600*x^4*z-178461803442200*x^3*y^2-48418007009200*x^3*y*z-34878298432800*x^3*z^2-70938053881800*x^2*y^3+223028981781800*x^2*y^2*z+126249739795200*x^2*y*z^2+11868185999200*x^2*z^3+60461883174800*x*y^4-55932326271600*x*y^3*z-75260690743200*x*y^2*z^2-12439881420000*x*y*z^3+2447415788800*x*z^4:
p2 := 1192900739670*t^4*x^5-24141755723172*t^4*x^4*y+139751494607042*t^4*x^4*z-1610202502150916*t^4*x^3*y^2-476387459316374*t^4*x^3*y*z-391883035718344*t^4*x^3*z^2-66976523589620*t^4*x^2*y^3+3050156628198578*t^4*x^2*y^2*z+1494021918085304*t^4*x^2*y*z^2+277850543364808*t^4*x^2*z^3+777519194433650*t^4*x*y^4-881512107495442*t^4*x*y^3*z-2178782555674504*t^4*x*y^2*z^2-767262695457392*t^4*x*y*z^3-35718686471680*t^4*x*z^4-195291882654604*t^4*y^5-114392576035756*t^4*y^4*z+516041783305944*t^4*y^3*z^2+407452987813416*t^4*y^2*z^3+52801468331776*t^4*y*z^4-11943389049344*t^4*z^5+128891149380*t^3*x^5-2215363202148*t^3*x^4*y+15306071697148*t^3*x^4*z-181795844582140*t^3*x^3*y^2-9304911925496*t^3*x^3*y*z-18082711216160*t^3*x^3*z^2-540658453891572*t^3*x^2*y^3-94855411938012*t^3*x^2*y^2*z-18708690152864*t^3*x^2*y*z^2-24642608090896*t^3*x^2*z^3-128023816736648*t^3*x*y^4+460207256120712*t^3*x*y^3*z+491493977184064*t^3*x*y^2*z^2+150440656633296*t^3*x*y*z^3+14741380912192*t^3*x*z^4+159619371581472*t^3*y^5-84780982855232*t^3*y^4*z-256857842884512*t^3*y^3*z^2-111112405321728*t^3*y^2*z^3-6476298994368*t^3*y*z^4+2545312420352*t^3*z^5+226217119320*t^2*x^4*y+122315070330*t^2*x^4*z-4497589696632*t^2*x^3*y^2+24191814236054*t^2*x^3*y*z+14395345923678*t^2*x^3*z^2-306954301920584*t^2*x^2*y^3-249248449257070*t^2*x^2*y^2*z-105019419822972*t^2*x^2*y*z^2-32436817542504*t^2*x^2*z^3-122013452676696*t^2*x*y^4+317637458554622*t^2*x*y^3*z+424566505504818*t^2*x*y^2*z^2+137825537928160*t^2*x*y*z^3+11037412979256*t^2*x*z^4+103994439060656*t^2*y^5-39974049834588*t^2*y^4*z-181465451510892*t^2*y^3*z^2-91389038433576*t^2*y^2*z^3-7359534563864*t^2*y*z^4+2276096683584*t^2*z^5+131521581000*t*x^5-2495193091890*t*x^4*y+15482812232030*t*x^4*z-180841342177046*t*x^3*y^2-34410684749132*t*x^3*y*z-34413932435262*t*x^3*z^2-233338295014202*t*x^2*y^3+173614741300162*t*x^2*y^2*z+93057948011076*t*x^2*y*z^2+10821837046216*t*x^2*z^3-4091745857638*t*x*y^4+144895905533384*t*x*y^3*z+46317441923886*t*x*y^2*z^2+2147660033128*t*x*y*z^3+2803461368776*t*x*z^4+55020313689068*t*y^5-49084560411912*t*y^4*z-70165198364460*t*y^3*z^2-13578112814496*t*y^2*z^3+1853951925208*t*y*z^4+73422473664*t*z^5-196677345028446*x^5+9456071042637452*x^4*y-785700392804042*x^4*z+9334382716570662*x^3*y^2-33011817245817996*x^3*y*z+6197706129838244*x^3*z^2+7739170372251751*x^2*y^3-12743178366817563*x^2*y^2*z+27926692098371436*x^2*y*z^2-10182010094586026*x^2*z^3-6894473570974261*x*y^4-6108574653199921*x*y^3*z+2405651542055316*x*y^2*z^2+2118207650471604*x*y*z^3+5760484085431100*x*z^4-9906545271265582*y^5+22646716425866686*y^4*z-1350782322251524*y^3*z^2-7287166017647328*y^2*z^3-3439258893134204*y*z^4-995561865922536*z^5:
p3 := 936433656720*t^4*x^5-17895875962182*t^4*x^4*y+108865379524532*t^4*x^4*z-1285003719249458*t^4*x^3*y^2-233033181949318*t^4*x^3*y*z-406527501336148*t^4*x^3*z^2-1484834244536094*t^4*x^2*y^3+3146031122985192*t^4*x^2*y^2*z+1202248320579776*t^4*x^2*y*z^2+440957694297520*t^4*x^2*z^3+41038692393494*t^4*x*y^4+1551177857600286*t^4*x*y^3*z-2122101240425932*t^4*x*y^2*z^2-1313687955281736*t^4*x*y*z^3-103867260495568*t^4*x*z^4+331935738629652*t^4*y^5-924988917277540*t^4*y^4*z+158447182315584*t^4*y^3*z^2+700869310399704*t^4*y^2*z^3+140571900792912*t^4*y*z^4-25012589361536*t^4*z^5+132836796810*t^3*x^5-2667330824106*t^3*x^4*y+15475829353246*t^3*x^4*z-179723445930502*t^3*x^3*y^2-48860107119492*t^3*x^3*y*z-53801721318648*t^3*x^3*z^2-35955073732178*t^3*x^2*y^3+449097037132098*t^3*x^2*y^2*z+192589505290752*t^3*x^2*y*z^2+53840825978552*t^3*x^2*z^3+75254112782908*t^3*x*y^4-15971781232516*t^3*x*y^3*z-368898023747832*t^3*x*y^2*z^2-166437605188280*t^3*x*y*z^3-11769933252352*t^3*x*z^4-12092376634960*t^3*y^5-61367794555440*t^3*y^4*z+82170929674560*t^3*y^3*z^2+92800805175840*t^3*y^2*z^3+14438374546240*t^3*y*z^4-2936898946560*t^3*z^5+1315215810*t^2*x^5+67231545204*t^2*x^4*y+27212732276*t^2*x^4*z-3641181223148*t^2*x^3*y^2+13042246603656*t^2*x^3*y*z-15363283571390*t^2*x^3*z^2-127417260982780*t^2*x^2*y^3+140961454180220*t^2*x^2*y^2*z+23464372309588*t^2*x^2*y*z^2+33950631339808*t^2*x^2*z^3-49761399424330*t^2*x*y^4+226601166067708*t^2*x*y^3*z-127453403981186*t^2*x*y^2*z^2-114160234356112*t^2*x*y*z^3-11487666261336*t^2*x*z^4+42927937054108*t^2*y^5-98359978332392*t^2*y^4*z+819266055780*t^2*y^3*z^2+64170554212704*t^2*y^2*z^3+13804350187448*t^2*y*z^4-2373993315136*t^2*z^5+127575933570*t*x^5-2688996432642*t*x^4*y+15005294076392*t*x^4*z-170074691171438*t*x^3*y^2-64737910595918*t*x^3*y*z-34915470140738*t*x^3*z^2+138205779727606*t*x^2*y^3+284995326699972*t*x^2*y^2*z+166310334274036*t*x^2*y*z^2+13953621309520*t*x^2*z^3+140936169182444*t*x*y^4-308002311578614*t*x*y^3*z-235064596908062*t*x*y^2*z^2-34671262522136*t*x*y*z^3+1543220295192*t*x*z^4-70135784482768*t*y^5+60649166652820*t*y^4*z+91217664101124*t*y^3*z^2+19698510799224*t*y^2*z^3-1968210615608*t*y*z^4-171319105216*t*z^5+250512874414322*x^5-12455868703640322*x^4*y+840137565130108*x^4*z+8201313139952319*x^3*y^2+31550998373976678*x^3*y*z-6613204340060652*x^3*z^2-15794265281302240*x^2*y^3-13019188848350769*x^2*y^2*z-8838109553993470*x^2*y*z^2+8030871784559150*x^2*z^3+23979290250112969*x*y^4+3708954356970583*x*y^3*z-8829438411470356*x*y^2*z^2-5823366112496600*x*y*z^3-3409848006509372*x*z^4-6051636190783482*y^5-5190187748680450*y^4*z+4265365423192040*y^3*z^2+4087394928088740*y^2*z^3+1687242745192500*y*z^4+456903290581112*z^5:
p4 := -93380322510*t^4*x^5+1193694420486*t^4*x^4*y-10918973621326*t^4*x^4*z+139886864206186*t^4*x^3*y^2-45048736584376*t^4*x^3*y*z+33122179842972*t^4*x^3*z^2+949813507604766*t^4*x^2*y^3-10693195597498*t^4*x^2*y^2*z+60003585061752*t^4*x^2*y*z^2-27260693213144*t^4*x^2*z^3+314599854510164*t^4*x*y^4-1122660665623608*t^4*x*y^3*z-462427947977964*t^4*x*y^2*z^2+17191517861640*t^4*x*y*z^3+4671155229520*t^4*x*z^4-304727891200992*t^4*y^5+314548341323256*t^4*y^4*z+349110425159064*t^4*y^3*z^2+22056229355472*t^4*y^2*z^3-19052511542352*t^4*y*z^4+1321604525952*t^4*z^5-1242878940450*t^3*x^5+23526900325170*t^3*x^4*y-146117463327270*t^3*x^4*z+1709997942104190*t^3*x^3*y^2+315102513698820*t^3*x^3*y*z+348174560091480*t^3*x^3*z^2+2276520840162810*t^3*x^2*y^3-1886015978885850*t^3*x^2*y^2*z-937256963580480*t^3*x^2*y*z^2-154008315811800*t^3*x^2*z^3+67077688934340*t^3*x*y^4-1563826017427740*t^3*x*y^3*z-157399352495400*t^3*x*y^2*z^2+162242893180440*t^3*x*y*z^3-8886256005120*t^3*x*z^4-544156948573200*t^3*y^5+575945196254160*t^3*y^4*z+610227425162880*t^3*y^3*z^2+21646103888160*t^3*y^2*z^3-36954599803200*t^3*y*z^4+2936898946560*t^3*z^5-1050857432190*t^2*x^5+20422025807514*t^2*x^4*y-123371013943034*t^2*x^4*z+1435271071778726*t^2*x^3*y^2+325379017295648*t^2*x^3*y*z+314588574954344*t^2*x^3*z^2+1205688306838658*t^2*x^2*y^3-2022696483329550*t^2*x^2*y^2*z-996200888835568*t^2*x^2*y*z^2-175744458497704*t^2*x^2*z^3-229132213669808*t^2*x*y^4-516120752874536*t^2*x*y^3*z+666786088305128*t^2*x*y^2*z^2+349805942993528*t^2*x*y*z^3+7979339365632*t^2*x*z^4-216453541765784*t^2*y^5+340509297017864*t^2*y^4*z+139670275910544*t^2*y^3*z^2-130070027040624*t^2*y^2*z^3-37622273418304*t^2*y*z^4+5678004630016*t^2*z^5-449803807020*t*x^5+11719302413562*t*x^4*y-52864071633972*t*x^4*z+555139298879358*t*x^3*y^2+490884126043234*t*x^3*y*z+127951945927552*t*x^3*z^2-3524720526389086*t*x^2*y^3-1884801855585600*t*x^2*y^2*z-1195169073941144*t*x^2*y*z^2-60121043239632*t*x^2*z^3-1704281957902614*t*x*y^4+4859705051088862*t*x*y^3*z+3047419799216224*t*x*y^2*z^2+363781655184824*t*x*y*z^3-1723977838144*t*x*z^4+1276350353820028*t*y^5-1146872753015588*t*y^4*z-1620075284301048*t*y^3*z^2-304751883592392*t*y^2*z^3+44698613706368*t*y*z^4+1370552841728*t*z^5+6338959732548*x^5-340163109491876*x^4*y+156173754588744*x^4*z+1473370552274326*x^3*y^2+1335829958261764*x^3*y*z-1077857794875538*x^3*z^2+2364298444347009*x^2*y^3-852346517037841*x^2*y^2*z-946067381595002*x^2*y*z^2+2151536932385772*x^2*z^3+424705196350141*x*y^4-31968669503249*x*y^3*z-2362229965628880*x*y^2*z^2-1231193046317358*x*y*z^3-1670353567417304*x*z^4-1209340103803758*y^5+2157444266477690*y^4*z-1477976690720608*y^3*z^2+478317689404900*y^2*z^3+1164739955442616*y*z^4+442498803440088*z^5:
p5 := 786499054380*t^4*x^5-15640914476418*t^4*x^4*y+93094969363148*t^4*x^4*z-1067123138252438*t^4*x^3*y^2-300568153944178*t^4*x^3*y*z-146037603626360*t^4*x^3*z^2-418855708109898*t^4*x^2*y^3+614180165358952*t^4*x^2*y^2*z+560411044611112*t^4*x^2*y*z^2-69936573393296*t^4*x^2*z^3+363690203001758*t^4*x*y^4-627755918240094*t^4*x*y^3*z+447190663560280*t^4*x*y^2*z^2+435302412301032*t^4*x*y*z^3+62583017853792*t^4*x*z^4-1813856495244*t^4*y^5+245943977814340*t^4*y^4*z-223708777414968*t^4*y^3*z^2-303679994159928*t^4*y^2*z^3-50330543410464*t^4*y*z^4+9887559786752*t^4*z^5+661553552430*t^3*x^5-14312855329338*t^3*x^4*y+76472461456798*t^3*x^4*z-874599649730374*t^3*x^3*y^2-352505367251924*t^3*x^3*y*z-338585094918668*t^3*x^3*z^2+1217214695334750*t^3*x^2*y^3+3429870008464386*t^3*x^2*y^2*z+1452988577224120*t^3*x^2*y*z^2+427314241057688*t^3*x^2*z^3+929796907606720*t^3*x*y^4-1500768132547452*t^3*x*y^3*z-3842809447412132*t^3*x*y^2*z^2-1497922261496952*t^3*x*y*z^3-112780179013904*t^3*x*z^4-533273809601736*t^3*y^5-143945130946880*t^3*y^4*z+1253326011257688*t^3*y^3*z^2+902967434557728*t^3*y^2*z^3+109530142909584*t^3*y*z^4-25795762413952*t^3*z^5-1367824442400*t^2*x^5+27285478289130*t^2*x^4*y-161645711679700*t^2*x^4*z+1854198490164766*t^2*x^3*y^2+527458972155890*t^2*x^3*y*z+284411238783044*t^2*x^3*z^2+614617115995602*t^2*x^2*y^3-1449893109949536*t^2*x^2*y^2*z-1092068204322160*t^2*x^2*y*z^2+53055055678288*t^2*x^2*z^3-677750842196362*t^2*x*y^4+1094532743295990*t^2*x*y^3*z-258703143627940*t^2*x*y^2*z^2-501259868256264*t^2*x*y*z^3-85506145359472*t^2*x*z^4+41718699390612*t^2*y^5-344530433991892*t^2*y^4*z+231087694321488*t^2*y^3*z^2+372235576980792*t^2*y^2*z^3+64634516879472*t^2*y*z^4-12383923891328*t^2*z^5+1185009444810*t*x^5-24958122758736*t*x^4*y+140382608562626*t*x^4*z-1580144698737944*t*x^3*y^2-619038441506778*t*x^3*y*z-206210980119020*t*x^3*z^2+1257897105115568*t*x^2*y^3+1278511152335258*t*x^2*y^2*z+1170308778971200*t*x^2*y*z^2-136518167208152*t*x^2*z^3+1298833080168482*t*x*y^4-3369895952142614*t*x*y^3*z-463391264782244*t*x*y^2*z^2+642981035004800*t*x*y*z^3+104891154531504*t*x*z^4-642709818148124*t*y^5+1016584572827212*t*y^4*z+409613505224448*t*y^3*z^2-393083681892936*t*y^2*z^3-112846402146544*t*y*z^4+17082962205824*t*z^5-2920051036628*x^5+196945223234634*x^4*y+43272068881914*x^4*z-2583079207467351*x^3*y^2+20691010491940*x^3*y*z+165344428984034*x^3*z^2-542584047592517*x^2*y^3+2957649268756986*x^2*y^2*z-2290089364363440*x^2*y*z^2-500559237418914*x^2*z^3-4918464974565406*x*y^4+2004093433479890*x*y^3*z+2223027418551872*x*y^2*z^2+3381713227250514*x*y*z^3+353557936309920*x*z^4-1369072744152140*y^5+5477597465409716*y^4*z-1200576446017268*y^3*z^2-2905695174166368*y^2*z^3-1120634188747176*y*z^4-72020570867872*z^5:

f := simplify(expand(p1^2+p2^2+p3^2+p4^2+p5^2));
fRed := f/10^31;

# Not conclusive...
out := exactSOS(fRed, facial = "no", objFunction = "eig");

# We try to use forceRational = "yes"
# It is slow, we need to check what is slow


# We look for a rational decomposition.
# We do facial reduction using the algebraic solutions of the polynomials
out := exactSOS(fRed, realPolynomials = [p1, p2, p3, p4, p5], facial = "yes", traceEquations = "no", objFunction = "eig", forceRational = "yes", printLevel = 10):
eig(out[3]);

out := exactSOS(fRed, facial = "yes", objFunction = "eig");


